#!/bin/bash

#
# packages/programs/package
#

DESCRIPTION='Configures pacman, installs AUR client, installs programs.'
INSTALL_MSG='Installing programs...'
UNINSTALL_MSG='Uninstalling programs...'

PROGRAMS='fortune-mod git neovim python-neovim python2-neovim tmux'

install() {
  echo -n 'checking if platform is Arch Linux... '
  local pacman_bin="$(which pacman)"
  if [[ -n ${pacman_bin} ]]; then
    success
  else
    failure
    echo 'skipping installation...'
    return 1
  fi

  echo -n 'copying pacman.conf... '
  if execute sudo cp "${PACKAGE_FILES}/pacman.conf" '/etc/pacman.conf'; then
    sudo chmod 644 /etc/pacman.conf
  else
    return 1
  fi

  echo -n 'checking for system updates... '
  execute sudo ${pacman_bin} -Syu --noconfirm --noprogressbar

  for program in ${PROGRAMS}; do
    echo -n "installing ${program}... "
    execute sudo pacman -S --noconfirm --noprogressbar "${program}"
  done
}

uninstall() {
  return
}

post_update() {
  echo -n 'checking for system updates... '
  execute sudo pacman -Syu --noconfirm
  return $?
}
